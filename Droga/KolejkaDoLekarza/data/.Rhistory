plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
res <- kknn(y~., ddf, grid, k=3)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
# par(mar=c(0,0,0,5))
# image( resG, xaxt="n", yaxt="n")
lv <- seq(0,300,10)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
res <- kknn(y~., ddf, grid, k=5)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
# par(mar=c(0,0,0,5))
# image( resG, xaxt="n", yaxt="n")
lv <- seq(0,300,10)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
res <- kknn(y~., ddf, grid, k=10)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
# par(mar=c(0,0,0,5))
# image( resG, xaxt="n", yaxt="n")
lv <- seq(0,300,10)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
?par
par(family="Inconsolata")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
windowsFonts(Calibri=windowsFont("TT Arial"))
par(family="Calibri")
windowsFonts(Calibri=windowsFont("Arial"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
windowsFonts(Calibri=windowsFont("Calibri"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
windowsFonts(Calibri=windowsFont("Minion Pro"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
getwd()
pdf("a.pdf",12,12)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
png("a.png",1000,100)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
png("a.png",1000,1000)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
png("a.png",900,700)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
lv <- seq(0,max(res$fitted.values),10)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
png(paste(grupa,".png",sep=""),900,700)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=3, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
table(dats3[,1])
which(table(dats3[,1])>10)
which(table(dats3[,1])>100)
x = seq(14,24.5,0.02)
y = seq(49,55,0.02)
grupy <- names(which(table(dats3[,1])>100))
for (grupa in grupy) {
dats4 <- dats3[dats3[,1] == grupa,]
all4 <- all[dats3[,1] == grupa,]
ddf <- data.frame(y=dats4[,8], all4[,2:1])
res <- kknn(y~., ddf, grid, k=10)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
lv <- seq(0,max(res$fitted.values),10)
png(paste(grupa,".png",sep=""),900,700)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
}
grupy[1]
grupa = grupy[1]
dats4 <- dats3[dats3[,1] == grupa,]
all4 <- all[dats3[,1] == grupa,]
ddf <- data.frame(y=dats4[,8], all4[,2:1])
res <- kknn(y~., ddf, grid, k=10)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
head(grid)
grid <- expand.grid(dlugosc = x, szerokosc=y)
x = seq(14,24.5,0.02)
y = seq(49,55,0.02)
grid <- expand.grid(dlugosc = x, szerokosc=y)
dats4 <- dats3[dats3[,1] == grupa,]
all4 <- all[dats3[,1] == grupa,]
ddf <- data.frame(y=dats4[,8], all4[,2:1])
res <- kknn(y~., ddf, grid, k=10)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
lv <- seq(0,max(res$fitted.values),10)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.of()
dev.ofd()
dev.off()
dev.off()
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dim(ddf)
head(ddf)
tail(ddf)
summary(ddf[,1])
points(ddf[,1],ddf[,2], pch=".")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,1],ddf[,2], pch=".")
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2],ddf[,1], pch=".")
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
head(ddf)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2],ddf[,3], pch=".")
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2],ddf[,3], pch=10, cex=0.3)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/100,ddf[,3] + rnorm(nrow(ddf))/100, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/30,ddf[,3] + rnorm(nrow(ddf))/30, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/10,ddf[,3] + rnorm(nrow(ddf))/10, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
for (grupa in grupy) {
dats4 <- dats3[dats3[,1] == grupa,]
all4 <- all[dats3[,1] == grupa,]
ddf <- data.frame(y=dats4[,8], all4[,2:1])
res <- kknn(y~., ddf, grid, k=10)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
lv <- seq(0,max(res$fitted.values)+1,10)
png(paste(grupa,".png",sep=""),900,700)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/30,ddf[,3] + rnorm(nrow(ddf))/30, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
}
grupa
dats4 <- dats3[dats3[,1] == grupa,]
all4 <- all[dats3[,1] == grupa,]
ddf <- data.frame(y=dats4[,8], all4[,2:1])
res <- kknn(y~., ddf, grid, k=10)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
lv <- seq(0,max(res$fitted.values) + 10,10)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/30,ddf[,3] + rnorm(nrow(ddf))/30, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
grupy
for (grupa in grupy) {
dats4 <- dats3[dats3[,1] == grupa,]
all4 <- all[dats3[,1] == grupa,]
ddf <- data.frame(y=dats4[,8], all4[,2:1])
res <- kknn(y~., ddf, grid, k=10)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
lv <- seq(0,max(res$fitted.values) + 1,length.out=101)
png(paste(grupa,".png",sep=""),900,700)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/30,ddf[,3] + rnorm(nrow(ddf))/30, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
}
filled.contour
fix(filled.contour)
filled.contour2 <- function (x = seq(0, 1, length.out = nrow(z)), y = seq(0, 1,
length.out = ncol(z)), z, xlim = range(x, finite = TRUE),
ylim = range(y, finite = TRUE), zlim = range(z, finite = TRUE),
levels = pretty(zlim, nlevels), nlevels = 20, color.palette = cm.colors,
col = color.palette(length(levels) - 1), plot.title, plot.axes,
key.title, key.axes, asp = NA, xaxs = "i", yaxs = "i", las = 1,
axes = TRUE, frame.plot = axes, ...)
{
mar.orig <- (par.orig <- par(c("mar", "las", "mfrow")))$mar
on.exit(par(par.orig))
w <- (3 + mar.orig[2L]) * par("csi") * 2.54
layout(matrix(c(2, 1), ncol = 2L), widths = c(1, lcm(w)))
par(las = las)
mar <- mar.orig
mar[4L] <- mar[2L]
mar[2L] <- 1
par(mar = mar)
plot.new()
browser()
plot.window(xlim = c(0, 1), ylim = range(levels), xaxs = "i",
yaxs = "i")
rect(0, levels[-length(levels)], 1, levels[-1L], col = col)
if (missing(key.axes)) {
if (axes)
axis(4)
}
else key.axes
box()
if (!missing(key.title))
key.title
mar <- mar.orig
mar[4L] <- 1
par(mar = mar)
plot.new()
plot.window(xlim, ylim, "", xaxs = xaxs, yaxs = yaxs, asp = asp)
.filled.contour(x, y, z, levels, col)
if (missing(plot.axes)) {
if (axes) {
title(main = "", xlab = "", ylab = "")
Axis(x, side = 1)
Axis(y, side = 2)
}
}
else plot.axes
if (frame.plot)
box()
if (missing(plot.title))
title(...)
else plot.title
invisible()
}
filled.contour2(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/30,ddf[,3] + rnorm(nrow(ddf))/30, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
plot.window(xlim = c(0, 1), ylim = range(levels), xaxs = "i",
yaxs = "i")
rect(0, levels[-length(levels)], 1, levels[-1L], col = col)
?rect(0, levels[-length(levels)], 1, levels[-1L], col = col)
rect(0, levels[-length(levels)], 1, levels[-1L], col = col,border=NA)
if (missing(key.axes)) {
if (axes)
axis(4)
}
else key.axes
box()
0
filled.contour2 <- function (x = seq(0, 1, length.out = nrow(z)), y = seq(0, 1,
length.out = ncol(z)), z, xlim = range(x, finite = TRUE),
ylim = range(y, finite = TRUE), zlim = range(z, finite = TRUE),
levels = pretty(zlim, nlevels), nlevels = 20, color.palette = cm.colors,
col = color.palette(length(levels) - 1), plot.title, plot.axes,
key.title, key.axes, asp = NA, xaxs = "i", yaxs = "i", las = 1,
axes = TRUE, frame.plot = axes, ...)
{
mar.orig <- (par.orig <- par(c("mar", "las", "mfrow")))$mar
on.exit(par(par.orig))
w <- (3 + mar.orig[2L]) * par("csi") * 2.54
layout(matrix(c(2, 1), ncol = 2L), widths = c(1, lcm(w)))
par(las = las)
mar <- mar.orig
mar[4L] <- mar[2L]
mar[2L] <- 1
par(mar = mar)
plot.new()
plot.window(xlim = c(0, 1), ylim = range(levels), xaxs = "i",
yaxs = "i")
rect(0, levels[-length(levels)], 1, levels[-1L], col = col,border=NA)
if (missing(key.axes)) {
if (axes)
axis(4)
}
else key.axes
box()
if (!missing(key.title))
key.title
mar <- mar.orig
mar[4L] <- 1
par(mar = mar)
plot.new()
plot.window(xlim, ylim, "", xaxs = xaxs, yaxs = yaxs, asp = asp)
.filled.contour(x, y, z, levels, col)
if (missing(plot.axes)) {
if (axes) {
title(main = "", xlab = "", ylab = "")
Axis(x, side = 1)
Axis(y, side = 2)
}
}
else plot.axes
if (frame.plot)
box()
if (missing(plot.title))
title(...)
else plot.title
invisible()
}
filled.contour2(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/30,ddf[,3] + rnorm(nrow(ddf))/30, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
for (k in c(5,10,20)) {
for (grupa in grupy) {
dats4 <- dats3[dats3[,1] == grupa,]
all4 <- all[dats3[,1] == grupa,]
ddf <- data.frame(y=dats4[,8], all4[,2:1])
res <- kknn(y~., ddf, grid, k=k)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
lv <- seq(0,max(res$fitted.values) + 1,length.out=101)
png(paste(grupa,k,".png",sep=""),900,700)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour2(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/30,ddf[,3] + rnorm(nrow(ddf))/30, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
}
}
dev.off()
dev.off()
sort(table(dats3[,1]))
grupy <- names(which(table(dats3[,1]) > 500))
for (grupa in grupy) {
dats4 <- dats3[dats3[,1] == grupa,]
all4 <- all[dats3[,1] == grupa,]
ddf <- data.frame(y=dats4[,8], all4[,2:1])
res <- kknn(y~., ddf, grid, k=12)
resG <- list(x = x, y = y, z = matrix(res$fitted.values, length(x), length(y)))
tx = readWKT("POLYGON ((12.9 48.9, 12.9 55.1, 25.1 55.1, 25.1 48.9, 12.9 48.9))")
d = gDifference(tx,shape0)
lv <- seq(0,max(res$fitted.values) + 1,length.out=101)
png(paste(grupa,".png",sep=""),900,700)
windowsFonts(Calibri=windowsFont("Palatino Linotype"))
par(family="Calibri")
filled.contour2(resG$x, resG$y, resG$z,  frame.plot = FALSE, plot.axes={
plot(d,col='white',add=TRUE)
plot(shape1, border="grey50", lwd=1, add=T)
plot(shape0, border="black", lwd=2, add=T)
points(ddf[,2] + rnorm(nrow(ddf))/30,ddf[,3] + rnorm(nrow(ddf))/30, pch=10, cex=0.2)
}, col = rev(heat.colors(length(lv) - 1)), levels=lv)
title(main=grupa)
dev.off()
}
